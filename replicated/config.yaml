apiVersion: kots.io/v1beta1
kind: Config
metadata:
  name: studio-config
spec:
  groups:
    - name: Rasa Platform Deployment
      description: >
        Deploy Rasa Platform or specific components
      title: Rasa Platform Deployment
      items:
        - name: rasa_platform_deploy
          type: select_one
          title: Rasa Platform deploy
          default: rasa_platform
          items:
            - name: rasa_platform
              title: Rasa Platform
            - name: studio
              title: Studio
            - name: rasa_pro
              title: Rasa Pro
    - name: API keys and images
      description: >
        This section configures your API Keys and image versions
      title: API keys and images
      items:
        - name: image_registry
          type: select_one
          title: Image Registry
          default: internal_registry
          items:
            - name: internal_registry
              title: Use Default Registry
            - name: external_registry
              title: Use Private Registry
        - name: image_pull_secrets
          type: text
          title: Image pull secret name
          help_text: Name of a secret thats used for connecting to the private registry. More information on how to create a secret [here](https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/#create-a-secret-by-providing-credentials-on-the-command-line).
          when: '{{repl ConfigOptionEquals "image_registry" "external_registry"}}'
        - name: studio_repository
          type: text
          title: Studio repository URL
          default: '{{repl (ConfigOptionEquals "image_registry" "internal_registry") | ternary "registry.rasa.com/proxy/studio-dragon/europe-west3-docker.pkg.dev/rasa-releases/studio/" ""}}'
          help_text: URL of your repository for Studio, without an image name
          when: '{{repl ConfigOptionEquals "image_registry" "external_registry"}}'
        - name: studio_image_tag
          type: text
          title: Studio version
          default: "1.2.0"
          help_text: Specifies image tag for Studio
        - name: rasa_config_image
          type: text
          title: Rasa Pro repository URL
          default: '{{repl (ConfigOptionEquals "image_registry" "internal_registry") | ternary "registry.rasa.com/proxy/studio-dragon/europe-west3-docker.pkg.dev/rasa-releases/rasa-pro/rasa-pro" ""}}'
          help_text: Rasa Pro docker image repository to be used for training. Please specify full repository and image name in format `repository/image_name`.
          when: '{{repl ConfigOptionEquals "image_registry" "external_registry"}}'
          validation:
            regex:
              pattern: '[^\/]$'
              message: You have `/` at the end of your image URL. Please remove the `/` from the end in in format `repository/image_name`.
        - name: docker_image_tag
          type: text
          title: Rasa Pro version
          default: "3.8.0"
          help_text: Rasa Plus docker image to be used for training
          when: 'repl{{ ConfigOptionNotEquals `rasa_platform_deploy` `rasa_pro` }}'
        - name: rasa_config_file
          type: text
          title: Rasa Pro config file
          default: ""
          help_text: base64 encoded Rasa Pro config file. This is required if you want to use a custom Rasa Pro config file and override the default one.
        - name: model_services_repository
          type: text
          title: Model services repository URL
          default: '{{repl (ConfigOptionEquals "image_registry" "internal_registry") | ternary "registry.rasa.com/proxy/studio-dragon/europe-west3-docker.pkg.dev/rasa-releases/model-training-and-running-services/" ""}}'
          help_text: URL of your repository for Model services, without an image name
          when: '{{repl ConfigOptionEquals "image_registry" "external_registry"}}'
        - name: model_service_image_tag
          type: text
          title: Model services version
          default: "3.2.2"
          help_text: Specifies image tag for Model Service
          when: 'repl{{ ConfigOptionNotEquals `rasa_platform_deploy` `rasa_pro` }}'
        - name: openai_api_key
          type: text
          title: OpenAI API key
          default: ""
          required: true
          help_text: OpenAI API key to be used
    - name: Model Services
      description: >
        This section can  be used to configure number of replicas for Model Services and resource management
      title: Model Service Replicas
      when: 'repl{{ ConfigOptionNotEquals `rasa_platform_deploy` `rasa_pro` }}'
      items:
        - name: training_consumer_replicas
          type: text
          title: Number of training consumer replicas
          default: "2"
          help_text: More information [here](https://rasa.com/docs/studio/deployment/architecture/#:~:text=consumer%20becomes%20available.-,TIP,-The%20number%20of).
        - name: running_consumer_replicas
          type: text
          title: Number of running consumer replicas
          default: "2"
          help_text: More information [here](https://rasa.com/docs/studio/deployment/architecture/#:~:text=consumer%20becomes%20available.-,TIP,-The%20number%20of).
        - name: rasa_training_debug_logs
          type: text
          title: Enable Rasa training debug logs
          default: "false"
          help_text: Set this to true if you want to include rasa debug logs during model training
        - name: rasa_running_debug_logs
          type: text
          title: Enable Rasa running debug logs
          default: "false"
          help_text: Set this to true if you want to include rasa debug logs during model running
        - name: configure_rasa_resources
          type: bool
          title: Configure Rasa Bot resources
          default: "0"
          help_text: Check this option if you want to configure resource requests/limits for Rasa bots
        - name: rasa_requests_cpu
          type: text
          title: Rasa requests CPU
          default: "1000m"
          help_text: Value of CPU requests to allocate to the container for Rasa bots
          when: '{{repl ConfigOptionEquals "configure_rasa_resources" "1"}}'
        - name: rasa_requests_memory
          type: text
          title: Rasa requests memory
          default: "1Gi"
          help_text: Value of Memory requests to allocate to the container for Rasa bots
          when: '{{repl ConfigOptionEquals "configure_rasa_resources" "1"}}'
        - name: rasa_limits_cpu
          type: text
          title: Rasa limits CPU
          default: "2500m"
          help_text: Value of Memory limits to allocate to the container for Rasa bots
          when: '{{repl ConfigOptionEquals "configure_rasa_resources" "1"}}'
        - name: rasa_limits_memory
          type: text
          title: Rasa limits memory
          default: "2.5Gi"
          help_text: Value of Memory limits to allocate to the container for Rasa bots
          when: '{{repl ConfigOptionEquals "configure_rasa_resources" "1"}}'
        - name: set_model_training_resources
          type: bool
          title: Configure MTS resources
          default: "0"
          help_text: Check this option if you want to configure resource requests/limits for Model Traning Service
        - name: set_model_training_orchestrator_limits_cpu
          type: text
          title: MTS orchestrator CPU limit
          help_text: Configure MTS orchestrator resource limit for CPU
          when: '{{repl ConfigOptionEquals "set_model_training_resources" "1"}}'
        - name: set_model_training_orchestrator_limits_memory
          type: text
          title: MTS orchestrator Memory limit
          help_text: Configure MTS orchestrator resource limit for Memory
          when: '{{repl ConfigOptionEquals "set_model_training_resources" "1"}}'
        - name: set_model_training_orchestrator_requests_cpu
          type: text
          title: MTS orchestrator CPU requests
          help_text: Configure MTS orchestrator resource requests for CPU
          when: '{{repl ConfigOptionEquals "set_model_training_resources" "1"}}'
        - name: set_model_training_orchestrator_requests_memory
          type: text
          title: MTS orchestrator Memory requests
          help_text: Configure MTS orchestrator resource requests for Memory
          when: '{{repl ConfigOptionEquals "set_model_training_resources" "1"}}'
        - name: set_model_training_consumer_limits_cpu
          type: text
          title: MTS consumer CPU limit
          help_text: Configure MTS consumer resource limit for CPU
          when: '{{repl ConfigOptionEquals "set_model_training_resources" "1"}}'
        - name: set_model_training_consumer_limits_memory
          type: text
          title: MTS consumer Memory limit
          help_text: Configure MTS consumer resource limit for Memory
          when: '{{repl ConfigOptionEquals "set_model_training_resources" "1"}}'
        - name: set_model_training_consumer_requests_cpu
          type: text
          title: MTS consumer CPU requests
          help_text: Configure MTS consumer resource requests for CPU
          when: '{{repl ConfigOptionEquals "set_model_training_resources" "1"}}'
        - name: set_model_training_consumer_requests_memory
          type: text
          title: MTS consumer Memory requests
          help_text: Configure MTS consumer resource requests for Memory
          when: '{{repl ConfigOptionEquals "set_model_training_resources" "1"}}'
        - name: set_model_running_resources
          type: bool
          title: Configure MRS resources
          default: "0"
          help_text: Check this option if you want to configure resource requests/limits for Model Running Service
        - name: set_model_running_orchestrator_limits_cpu
          type: text
          title: MRS orchestrator CPU limit
          help_text: Configure MRS orchestrator resource limit for CPU
          when: '{{repl ConfigOptionEquals "set_model_running_resources" "1"}}'
        - name: set_model_running_orchestrator_limits_memory
          type: text
          title: MRS orchestrator Memory limit
          help_text: Configure MRS orchestrator resource limit for Memory
          when: '{{repl ConfigOptionEquals "set_model_running_resources" "1"}}'
        - name: set_model_running_orchestrator_requests_cpu
          type: text
          title: MRS orchestrator CPU requests
          help_text: Configure MRS orchestrator resource requests for CPU
          when: '{{repl ConfigOptionEquals "set_model_running_resources" "1"}}'
        - name: set_model_running_orchestrator_requests_memory
          type: text
          title: MRS orchestrator Memory requests
          help_text: Configure MRS orchestrator resource requests for Memory
          when: '{{repl ConfigOptionEquals "set_model_running_resources" "1"}}'
        - name: set_model_running_consumer_limits_cpu
          type: text
          title: MRS consumer CPU limit
          help_text: Configure MRS consumer resource limit for CPU
          when: '{{repl ConfigOptionEquals "set_model_running_resources" "1"}}'
        - name: set_model_running_consumer_limits_memory
          type: text
          title: MRS consumer Memory limit
          help_text: Configure MRS consumer resource limit for Memory
          when: '{{repl ConfigOptionEquals "set_model_running_resources" "1"}}'
        - name: set_model_running_consumer_requests_cpu
          type: text
          title: MRS consumer CPU requests
          help_text: Configure MRS consumer resource requests for CPU
          when: '{{repl ConfigOptionEquals "set_model_running_resources" "1"}}'
        - name: set_model_running_consumer_requests_memory
          type: text
          title: MRS consumer Memory requests
          help_text: Configure MRS consumer resource requests for Memory
          when: '{{repl ConfigOptionEquals "set_model_running_resources" "1"}}'
    - name: Database
      description: >
        This section can be used to configure the database required by Rasa Studio.
      title: Database
      items:
        - name: postgres_type
          type: select_one
          title: PostgreSQL
          default: embedded_postgres
          items:
            - name: embedded_postgres
              title: Embedded Postgres
            - name: external_postgres
              title: External Postgres
        - name: wait_for_it
          type: bool
          title: Wait for PostgreSQL to be ready
          default: '{{repl (ConfigOptionEquals "postgres_type" "embedded_postgres") | ternary "1" "0"}}'
          when: '{{repl ConfigOptionEquals "postgres_type" "embedded_postgres"}}'
          help_text: Enable this if you are using Embedded PostgreSQL
        - name: database_host
          type: text
          title: Database Host
          required: true
          default: postgresql.postgresql.svc.cluster.local
          help_text: The database host name
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
        - name: database_username
          type: text
          title: Database Username
          required: true
          default: postgres
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
          help_text: The database username
        - name: database_password
          type: text
          title: Database Password
          default: postgres
          required: true
          help_text: The database password
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
        - name: database_port
          type: text
          title: Database port
          required: true
          default: "5432"
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
          help_text: The database port
        - name: studio_database
          type: text
          title: Studio database name
          default: studio
          help_text: The database name for Studio
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
        - name: rasa_pro_database
          type: text
          title: Rasa Pro database name
          default: rasa
          help_text: The database name for Rasa Pro
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
        - name: model_service_database
          type: text
          title: MTS DB database
          default: modelservice
          help_text: The database name for model training and running service
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
        - name: keycloak_database
          type: text
          title: Keycloak DB database
          default: keycloak
          help_text: The database name for keycloak user management service
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
        - name: prefer_ssl
          type: text
          title: Prefer SSL
          default: "false"
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
          help_text: Set to true if you want to use SSL for db connection
        - name: reject_unauthorized
          type: "text"
          title: Reject Unauthorized
          default: ""
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
          help_text: If true the server will reject db connection which is not present list of supplied CAs.
    - name: Kafka
      description: >
        This section covers Kafka configuration
      title: Kafka
      items:
        - name: kafka_type
          type: select_one
          title: Kafka
          default: embedded_kafka
          items:
            - name: embedded_kafka
              title: Embedded Kafka
            - name: external_kafka
              title: External Kafka
        - name: kafka_broker
          type: text
          title: Kafka broker address
          default: "kafka.kafka.svc.cluster.local:9092"
          help_text: Kafka broker address
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
        - name: kafka_sasl_mechanism
          type: text
          title: Kafka SASL mechanism
          default: ""
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: Supported values are plain, SCRAM-SHA-256 or SCRAM-SHA-512. You can leave it empty if you are not using SASL.
        - name: kafka_username
          type: text
          title: Kafka SASL username
          default: "kafka"
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: Kafka SASL username
        - name: kafka_password
          type: text
          title: Kafka SASL password
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          default: kafka
          help_text: Kafka SASL password
        - name: kafka_group_id
          type: text
          title: Kafka group ID
          default: "studio"
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: This is the Kafka group id that should be unique for Studio so that Studio can receive a copy of all the Rasa Pro events streamed to the topic.
        - name: kafka_topic
          type: text
          title: Kafka topic
          default: rasa-events
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: Kafka topic to which to Rasa Pro assistant will publish events. Make sure that you pre-create these on your own.
        - name: kafka_dlq_topic
          type: text
          title: Kafka DLQ topic
          default: rasa-events-dlq
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: Kafka topic to which unprocessed Rasa Pro assistant events will be pushed by Studio. Make sure that you pre-create these on your own.
        - name: training_result_topic
          type: text
          title: Training result topic
          default: training-result
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: Kafka topic for internal service communication. Please make sure to pre-create this topic.
        - name: training_job_topic
          type: text
          title: Training job topic
          default: training-job
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: Kafka topic for internal service communication. Please make sure to pre-create this topic.
        - name: kafka_training_status_update_topic
          type: text
          title: Training status update topic
          default: training-status-update
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: Kafka topic for internal service communication. Please make sure to pre-create this topic.
        - name: deployment_result_topic
          type: text
          title: Deployment result topic
          default: deployment-result
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: Kafka topic for internal service communication. Please make sure to pre-create this topic.
        - name: deployment_job_topic
          type: text
          title: Deployment job topic
          default: deployment-job
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: Kafka topic for internal service communication. Please make sure to pre-create this topic.
        - name: rasa_assistant_topic
          type: text
          title: Rasa Assistant
          default: rasa-assistant
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
        - name: rasa_core_events_topic
          type: text
          title: Rasa Assistant
          default: rasa_core_events
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
        - name: kafka_security_protocol
          type: text
          title: Kafka Security Protocol
          default: PLAINTEXT
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: Kafka security protocol
        - name: kafka_ssl
          type: text
          title: Kafka Enable SSL
          default: ""
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: Set to true if you want to use SSL
        - name: kafka_custom_ssl
          type: text
          title: Kafka custom SSL
          default: ""
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
          help_text: Set to true if you want to use SSL with custom certs
        - name: kafka_ca_file
          type: text
          title: Kafka CA file
          default: ""
          when: '{{repl ConfigOptionEquals "kafka_custom_ssl" "true"}}'
          help_text: Path to the CA file
        - name: kafka_key_file
          type: text
          title: Kafka key file
          default: ""
          when: '{{repl ConfigOptionEquals "kafka_custom_ssl" "true"}}'
          help_text: Path to the client key file
        - name: kafka_cert_file
          type: text
          title: Kafka certificate file
          default: ""
          when: '{{repl ConfigOptionEquals "kafka_custom_ssl" "true"}}'
          help_text: Path to the client certificate file
        - name: kafka_reject_unauthorized
          type: text
          title: Kafka reject unauthorized
          default: ""
          when: '{{repl ConfigOptionEquals "kafka_custom_ssl" "true"}}'
          help_text: Defaults to true, the server certificate is verified against the list of supplied CA
        - name: node_tls_reject_unauthorized
          type: text
          title: Node TLS reject unauthorized
          default: ""
          when: '{{repl ConfigOptionEquals "kafka_type" "external_kafka"}}'
    - name: Keycloak
      description: >
        This section covers Keycloak section
      title: Keycloak
      when: 'repl{{ ConfigOptionNotEquals `rasa_platform_deploy` `rasa_pro` }}'
      items:
        - name: keycloak_realm
          type: text
          title: Keycloak realm
          default: rasa-studio
          hidden: true
          help_text: Keycloak realm name
        - name: keycloak_api_username
          type: text
          title: Keycloak API username
          required: true
          default: realmadmin
          hidden: true
          help_text: These credentials are used by Studio Backend Server to communicate with Keycloak's user management module
        - name: keycloak_api_password
          type: text
          title: Keycloak API password
          required: true
          default: realmadmin
          hidden: true
          help_text: These credentials are used by Studio Backend Server to communicate with Keycloak's user management module
        - name: keycloak_api_client_id
          type: text
          title: Keycloak API client ID
          default: admin-cli
          hidden: true
          help_text: Keycloak API client ID
        - name: keycloak_admin_username
          type: text
          title: Keycloak admin username
          required: true
          default: kcadmin
          help_text: The admin username for Keycloak. This username is used to login to Keycloak admin console.
        - name: keycloak_admin_password
          type: text
          title: Keycloak Admin Password
          required: true
          default: studio
          help_text: The admin password for Keycloak. This password is used to login to Keycloak admin console.
        - name: keycloak_client_id
          type: text
          title: Keycloak Client ID
          default: rasa-studio-backend
          hidden: true
          help_text: Keycloak client id
        - name: keycloak_proxy
          type: text
          title: Keycloak proxy
          hidden: true
          default: "edge"
        - name: set_keycloak_resources
          type: bool
          title: Configure Keycloak resources
          default: "0"
          help_text: Check this option if you want to configure resource requests/limits for Keycloak deployment
        - name: set_keycloak_limits_cpu
          type: text
          title: Keycloak CPU limit
          help_text: Configure Keycloak resource limit for CPU
          when: '{{repl ConfigOptionEquals "set_keycloak_resources" "1"}}'
        - name: set_keycloak_limits_memory
          type: text
          title: Keycloak Memory limit
          help_text: Configure Keycloak resource limit for Memory
          when: '{{repl ConfigOptionEquals "set_keycloak_resources" "1"}}'
        - name: set_keycloak_requests_cpu
          type: text
          title: Keycloak CPU requests
          help_text: Configure Keycloak resource requests for CPU
          when: '{{repl ConfigOptionEquals "set_keycloak_resources" "1"}}'
        - name: set_keycloak_requests_memory
          type: text
          title: Keycloak Memory requests
          help_text: Configure Keycloak resource requests for Memory
          when: '{{repl ConfigOptionEquals "set_keycloak_resources" "1"}}'
    - name: Object Storage
      description: >
        This section covers object storage for MTS/MRS
      title: Object Storage
      when: 'repl{{ ConfigOptionNotEquals `rasa_platform_deploy` `rasa_pro` }}'
      items:
        - name: bucket_provider
          type: select_one
          title: Bucket Provider
          default: gcp_bucket
          items:
            - name: gcp_bucket
              title: Google Cloud Storage
            - name: aws_bucket
              title: AWS S3 Bucket
        - name: storage_type
          type: text
          title: Storage Type
          default: '{{repl (ConfigOptionEquals "bucket_provider" "gcp_bucket") | ternary "gcs" "aws_s3"}}'
          help_text: Put `gcs` for Google Cloud storage or `aws` for AWS S3 bucket
          hidden: true
        - name: bucket_name
          type: text
          title: Bucket Name
          default: ""
          help_text: Name of the storage bucket. Make sure to pre-create this bucket.
        - name: gcp_credentials
          type: text
          title: GCP SA Base64Encoded
          when: '{{repl ConfigOptionEquals "bucket_provider" "gcp_bucket"}}'
          help_text: GCP credentials for the service account. This is the base64 encoded service account JSON. This is only required if you are using GCS for object storage.
        - name: google_cloud_project
          type: text
          title: Google Cloud project
          default: ""
          when: '{{repl ConfigOptionEquals "bucket_provider" "gcp_bucket"}}'
          help_text: The project ID of the GCP project.
        - name: cloudsdk_compute_zone
          type: text
          title: CloudSDK Compute Zone
          default: ""
          when: '{{repl ConfigOptionEquals "bucket_provider" "gcp_bucket"}}'
          help_text: The zone where the bucket is located.
        - name: url_service_account
          type: text
          title: Storage Signed Url Service Account Email
          default: ""
          when: '{{repl ConfigOptionEquals "bucket_provider" "gcp_bucket"}}'
          help_text: The service account email address.
        - name: aws_access_key_id
          type: text
          title: AWS Access Key ID
          default: ""
          when: '{{repl ConfigOptionEquals "bucket_provider" "aws_bucket"}}'
          help_text: AWS access key ID used for S3
        - name: aws_secret_access_key
          type: text
          title: AWS Secret Access Key
          default: ""
          when: '{{repl ConfigOptionEquals "bucket_provider" "aws_bucket"}}'
          help_text: AWS secret access key ID used for S3
        - name: aws_region_name
          type: text
          title: AWS Region Name
          default: ""
          when: '{{repl ConfigOptionEquals "bucket_provider" "aws_bucket"}}'
          help_text: The region where the bucket is located.
        - name: custom_s3_endpoint
          type: bool
          title: Use custom S3 Endpoint
          default: "0"
          when: '{{repl ConfigOptionEquals "bucket_provider" "aws_bucket"}}'
          help_text: Enable this option to specify a custom URL endpoint for an S3-compatible storage service, such as MinIO. This is useful if you are not using Amazon's standard S3 service or if you are operating in a private environment that mimics S3.
        - name: aws_endpoint_url
          type: text
          title: Endpoint URL
          default: ""
          help_text: A custom URL endpoint for an S3-compatible storage service.
          when: '{{repl ConfigOptionEquals "custom_s3_endpoint" "1"}}'
    - name: NFS
      description: >
        This section covers NFS server configuration
      title: NFS Server
      when: 'repl{{ ConfigOptionNotEquals `rasa_platform_deploy` `rasa_pro` }}'
      items:
        - name: nfs_type
          type: select_one
          title: NFS Server
          default: embedded_nfs
          items:
            - name: embedded_nfs
              title: Embedded NFS
            - name: external_nfs
              title: External NFS
        - name: persistence_type
          type: text
          title: Persistence Type
          default: '{{repl (ConfigOptionEquals "nfs_type" "embedded_nfs") | ternary "local" ""}}'
          help_text: Type of the volume that will be used to store the training data. Valid value is `nfs`. Leave this empty if you are using AWS EFS.
          when: '{{repl ConfigOptionEquals "nfs_type" "external_nfs"}}'
        - name: nfs_aws_type
          type: bool
          title: Using AWS NFS
          default: "0"
          when: '{{repl ConfigOptionEquals "nfs_type" "external_nfs"}}'
          help_text: Please check this if you are using AWS NFS
        - name: efs_id
          type: text
          title: AWS EFS volume ID
          default: ""
          help_text: Fill this if you are using AWS NFS. `FileSystemId::MountPoint` of the AWS EFS volume. For example `fs-0bbaea252301ca2d4::fsap-0b4550cc4c77377fd`.
          when: '{{repl ConfigOptionEquals "nfs_aws_type" "1"}}'
        - name: host_path
          type: text
          title: Host Path
          default: /
          help_text: Directory from the host machine that will be mounted to the container for training data.
          when: '{{repl ConfigOptionEquals "nfs_type" "embedded_nfs"}}'
        - name: local_node_name
          type: text
          title: Local Node Name
          default: ""
          help_text: Node on which the PV will be created
          when: '{{repl ConfigOptionEquals "nfs_type" "embedded_nfs"}}'
        - name: storage_class_name
          type: text
          title: Storage Class name
          default: "openebs-hostpath"
          help_text: Storage Class name for PV. Should be `efs-sc` if you are using AWS EFS. It's `standard-rwo` if you are using NFS server.
          when: '{{repl ConfigOptionEquals "nfs_type" "external_nfs"}}'
        - name: storage_capacity
          type: text
          title: Storage Capacity
          default: 1Gi
          when: '{{repl ConfigOptionEquals "nfs_type" "external_nfs"}}'
          help_text: Storage Capacity for PV
        - name: storage_requests
          type: text
          title: Storage Requests
          default: 1Gi
          when: '{{repl ConfigOptionEquals "nfs_type" "external_nfs"}}'
          help_text: Storage requests for PVC
        - name: nfs_server
          type: text
          title: NFS Server Address
          default: ""
          help_text: DNS name or IP address of the NFS server. This value is used only when type is set to nfs
          when: '{{repl ConfigOptionEquals "nfs_type" "external_nfs"}}'
    - name: Ingress
      description: >
        This section covers Ingress configuration. Pick `Virtual Machine` if you are deploying on a VM, `Kubernetes` if you are deploying in Kubernetes cluster without an Ingress present, or `Do not install` if you already have a controller installed.
      title: Ingress
      items:
        - name: install_nginx
          type: select_one
          title: Deploy on
          default: on_vm
          items:
            - name: on_vm
              title: Virtual Machine
            - name: on_kubernetes
              title: Kubernetes
            - name: no_ingress
              title: Do not install
        - name: ingress_hostname
          type: text
          title: Ingress DNS Hostname
          default: ""
          help_text: Defines the host name for all resources. Make sure you provide a valid host name.
        - name: rasa_ingress_hosts_path
          type: text
          title: Path
          default: '{{repl (ConfigOptionEquals "rasa_platform_deploy" "rasa_pro") | ternary "/" "/rasapro(/|$)(.*)"}}'
          when: 'repl{{ ConfigOptionEquals `rasa_platform_deploy` `rasa_pro` }}'
        - name: rasa_ingress_hosts_path_type
          type: text
          title: Path type
          default: '{{repl (ConfigOptionEquals "rasa_platform_deploy" "rasa_pro") | ternary "ImplementationSpecific" "Prefix"}}'
          when: 'repl{{ ConfigOptionEquals `rasa_platform_deploy` `rasa_pro` }}'
        - name: connection_type
          type: text
          title: Connection type
          default: http
          help_text: Define if you will be using https or http with the ingressHost
          when: 'repl{{ ConfigOptionNotEquals `rasa_platform_deploy` `rasa_pro` }}'
        - name: ingress_class
          type: text
          title: Ingress Class Name
          default: nginx
          help_text: Ingress class name
          when: 'repl{{ ConfigOptionEquals `install_nginx` `no_ingress` }}'
        - name: annotations
          type: textarea
          title: Annotations
          help_text: |
            Use this textarea to provide annotations specific to your ingress controller.
            For example, `kubernetes.io/tls-acme: true`.
          default: ""
    - name: Resource Management
      description: >
        Set resource limits and requests for pods
      title: Resource Management
      when: 'repl{{ ConfigOptionNotEquals `rasa_platform_deploy` `rasa_pro` }}'
      items:
        - name: set_backend_resources
          type: bool
          title: Configure Backend resources
          default: "0"
          help_text: Check this option if you want to configure resource requests/limits for Backend deployment
        - name: set_backend_limits_cpu
          type: text
          title: Backend CPU limit
          help_text: Configure Backend resource limit for CPU
          when: '{{repl ConfigOptionEquals "set_backend_resources" "1"}}'
        - name: set_backend_limits_memory
          type: text
          title: Backend Memory limit
          help_text: Configure Backend resource limit for Memory
          when: '{{repl ConfigOptionEquals "set_backend_resources" "1"}}'
        - name: set_backend_requests_cpu
          type: text
          title: Backend CPU requests
          help_text: Configure Backend resource requests for CPU
          when: '{{repl ConfigOptionEquals "set_backend_resources" "1"}}'
        - name: set_backend_requests_memory
          type: text
          title: Backend Memory requests
          help_text: Configure Backend resource requests for Memory
          when: '{{repl ConfigOptionEquals "set_backend_resources" "1"}}'
        - name: set_webclient_resources
          type: bool
          title: Configure Web client resources
          default: "0"
          help_text: Check this option if you want to configure resource requests/limits for Web client deployment
        - name: set_webclient_limits_cpu
          type: text
          title: Web client CPU limit
          help_text: Configure Web client resource limit for CPU
          when: '{{repl ConfigOptionEquals "set_webclient_resources" "1"}}'
        - name: set_webclient_limits_memory
          type: text
          title: Web client Memory limit
          help_text: Configure Web client resource limit for Memory
          when: '{{repl ConfigOptionEquals "set_webclient_resources" "1"}}'
        - name: set_webclient_requests_cpu
          type: text
          title: Web client CPU requests
          help_text: Configure Web client resource requests for CPU
          when: '{{repl ConfigOptionEquals "set_webclient_resources" "1"}}'
        - name: set_webclient_requests_memory
          type: text
          title: Web client Memory requests
          help_text: Configure Web client resource requests for Memory
          when: '{{repl ConfigOptionEquals "set_webclient_resources" "1"}}'
        - name: set_eventingestion_resources
          type: bool
          title: Configure Event ingestion resources
          default: "0"
          help_text: Check this option if you want to configure resource requests/limits for Event ingestion deployment
        - name: set_eventingestion_limits_cpu
          type: text
          title: Event ingestion CPU limit
          help_text: Configure Event ingestion resource limit for CPU
          when: '{{repl ConfigOptionEquals "set_eventingestion_resources" "1"}}'
        - name: set_eventingestion_limits_memory
          type: text
          title: Event ingestion Memory limit
          help_text: Configure Event ingestion resource limit for Memory
          when: '{{repl ConfigOptionEquals "set_eventingestion_resources" "1"}}'
        - name: set_eventingestion_requests_cpu
          type: text
          title: Event ingestion CPU requests
          help_text: Configure Event ingestion resource requests for CPU
          when: '{{repl ConfigOptionEquals "set_eventingestion_resources" "1"}}'
        - name: set_eventingestion_requests_memory
          type: text
          title: Event ingestion Memory requests
          help_text: Configure Event ingestion resource requests for Memory
          when: '{{repl ConfigOptionEquals "set_eventingestion_resources" "1"}}'
    - name: Rasa Pro
      description: >
        This section configures Rasa Pro deployment
      title: Rasa Pro
      when: 'repl{{ ConfigOptionNotEquals `rasa_platform_deploy` `studio` }}'
      items:
        - name: rasa_pro_image_tag
          type: text
          title: Rasa Pro version
          default: "3.8.0-latest"
          help_text: Specifies image tag for Rasa Pro
        - name: rasa_auth_token
          type: text
          title: Rasa Auth Token
          default: ""
        - name: rasa_jwt_secret
          type: text
          title: Rasa JWT secret
          default: ""
        - name: heading_settings
          type: heading
          title: Settings
        - name: rasa_enable_api
          type: bool
          title: Rasa Pro enable API
          default: "1"
        - name: rasa_credentials
          type: bool
          title: Rasa Pro enable credentials
          default: "1"
        - name: additional_channel_credentials
          type: heading
          title: Additional Channel Credentials
          help_text: additionalChannelCredentials defines credentials which should be used by Rasa to connect to various channels
          when: '{{repl ConfigOptionEquals "rasa_credentials" "1"}}'
        - name: rasa_bot_message_event
          type: text
          title: Rasa Bot message event
          default: "bot_uttered"
          when: '{{repl ConfigOptionEquals "rasa_credentials" "1"}}'
        - name: rasa_metadata_key
          type: text
          title: Rasa Bot metadata key
          default: "customData"
          when: '{{repl ConfigOptionEquals "rasa_credentials" "1"}}'
        - name: rasa_session_persistence
          type: bool
          title: Rasa Bot session persistence
          default: "0"
          when: '{{repl ConfigOptionEquals "rasa_credentials" "1"}}'
        - name: rasa_user_message_event
          type: text
          title: Rasa Bot user message event
          default: "user_uttered"
          when: '{{repl ConfigOptionEquals "rasa_credentials" "1"}}'
        - name: endpoints
          type: heading
          title: Endpoints
        # Action Server
        - name: heading_action_server
          type: heading
          title: Action Server
        - name: rasa_action_endpoint_url
          type: text
          title: Action Server URL
          default: "http://action-server.kotsadm.svc.cluster.local:5055/webhook"
          help_text: Action Server is deployed in cluster
        # Event Broker configuration
        - name: heading_event_broker
          type: heading
          title: Event Broker
        - name: rasa_event_broker
          type: bool
          title: Enable Event Broker
          default: "1"
          help_text: "Allows you to connect your running assistant to other services that process the data. More info: https://rasa.com/docs/rasa/event-brokers"
        - name: rasa_event_broker_type
          type: text
          title: Event Broker type
          default: "kafka"
          when: '{{repl ConfigOptionEquals "rasa_event_broker" "1"}}'
        - name: rasa_event_broker_ssl_check_hostname
          type: bool
          title: Event Broker SSL check hostname
          default: "0"
          when: '{{repl ConfigOptionEquals "rasa_event_broker" "1"}}'
        # Lock Store configuration
        - name: heading_lock_store
          type: heading
          title: Lock Store
        - name: rasa_lock_store
          type: bool
          title: Enable Lock Store
          default: "1"
          help_text: "lockStore makes lock mechanism to ensure that incoming messages for a given conversation ID are processed in the right order. More: https://rasa.com/docs/rasa/lock-stores"
        - name: rasa_lock_store_use_concurrent
          type: bool
          title: Lock Store use concurrent
          default: "1"
          when: '{{repl ConfigOptionEquals "rasa_lock_store" "1"}}'
        - name: rasa_lock_store_db
          type: text
          title: Lock Store database
          default: "0"
          help_text: "Number of database within redis, e.g. 0"
          when: '{{repl ConfigOptionEquals "rasa_lock_store" "1"}}'
        - name: rasa_lock_store_port
          type: text
          title: Lock Store port
          default: "6379"
          when: '{{repl ConfigOptionEquals "rasa_lock_store" "1"}}'
        - name: rasa_lock_store_url
          type: text
          title: Lock Store URL
          default: "redis-master.redis.svc.cluster.local"
          help_text: "URL of the redis instance"
          when: '{{repl ConfigOptionEquals "rasa_lock_store" "1"}}'
        - name: redis_password
          type: password
          title: Lock Store Password
          default: 'redis'
          when: '{{repl ConfigOptionEquals "rasa_lock_store" "1"}}'
        - name: rasa_lock_store_use_ssl
          type: bool
          title: Lock Store use SSL
          default: "0"
          when: '{{repl ConfigOptionEquals "rasa_lock_store" "1"}}'
        # Models
        - name: heading_rasa_models
          type: heading
          title: Rasa Models
        - name: rasa_models
          type: bool
          title: Enable Rasa Models
          default: "0"
          help_text: "Models provides loading models from the storage. More: https://rasa.com/docs/rasa/model-storage"
        # Tracing
        - name: heading_rasa_tracing
          type: heading
          title: Tracing
        - name: rasa_tracing
          type: bool
          title: Enable Tracing
          default: "1"
          help_text: "Tracing tracks requests as they flow through a distributed system. More: https://rasa.com/docs/rasa/monitoring/tracing/"
        - name: rasa_tracing_host
          type: text
          title: Tracing host
          default: "jaeger"
          when: '{{repl ConfigOptionEquals "rasa_tracing" "1"}}'
        - name: rasa_tracing_port
          type: text
          title: Tracing port
          default: "6831"
          when: '{{repl ConfigOptionEquals "rasa_tracing" "1"}}'
        - name: rasa_tracing_service_name
          type: text
          title: Tracing Service name
          default: "rasa-jaeger"
          when: '{{repl ConfigOptionEquals "rasa_tracing" "1"}}'
        - name: rasa_tracing_sync_export
          type: text
          title: Tracing Sync export
          default: "null"
          when: '{{repl ConfigOptionEquals "rasa_tracing" "1"}}'
        - name: rasa_tracing_type
          type: text
          title: Tracing type
          default: "jaeger"
          when: '{{repl ConfigOptionEquals "rasa_tracing" "1"}}'
        # Tracker Store
        - name: heading_tracker_store
          type: heading
          title: Tracker Store
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
        - name: rasa_tracker_store
          type: bool
          title: Enable Tracker Store
          default: "1"
          help_text: "TrackerStore assistant's conversations are stored within a tracker store. More: https://rasa.com/docs/rasa/tracker-stores"
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
        - name: rasa_tracker_store_dialect
          type: text
          title: Tracker Store dialect
          default: "postgresql"
          when: '{{repl and (ConfigOptionEquals "postgres_type" "external_postgres") (ConfigOptionEquals "rasa_tracker_store" "1") }}'
        - name: rasa_tracker_store_type
          type: text
          title: Tracker Store type
          default: "sql"
          when: '{{repl and (ConfigOptionEquals "postgres_type" "external_postgres") (ConfigOptionEquals "rasa_tracker_store" "1") }}'
        # Additional Endpoints
        - name: heading_additional_endpoints
          type: heading
          title: Additional Endpoints
        - name: enable_vector_store
          type: bool
          title: Enable Vector Store
          default: "0"
          help_text: "Specify if using external vector DB"
        - name: rasa_additional_endpoints_vector_store_type
          type: text
          title: Vector Store type
          when: '{{repl ConfigOptionEquals "enable_vector_store" "1"}}'
        - name: rasa_additional_endpoints_vector_store_collection
          type: text
          title: Vector Store collection
          when: '{{repl ConfigOptionEquals "enable_vector_store" "1"}}'
        - name: rasa_additional_endpoints_vector_store_content_payload_key
          type: text
          title: Vector Store payload key
          when: '{{repl ConfigOptionEquals "enable_vector_store" "1"}}'
        - name: rasa_additional_endpoints_vector_store_host
          type: text
          title: Vector Store host
          when: '{{repl ConfigOptionEquals "enable_vector_store" "1"}}'
        - name: rasa_additional_endpoints_vector_store_metadata_payload_key
          type: text
          title: Vector Store metadata payload key
          when: '{{repl ConfigOptionEquals "enable_vector_store" "1"}}'
        - name: rasa_additional_endpoints_vector_store_port
          type: text
          title: Vector Store port
          when: '{{repl ConfigOptionEquals "enable_vector_store" "1"}}'
        - name: settings_environment
          type: text
          title: Environment
          help_text: "Environment: development or production"
          when: '{{repl ConfigOptionEquals "enable_vector_store" "1"}}'
        # Additional Arguments
        - name: heading_additional_arguments
          type: heading
          title: Additional Arguments
          help_text: "More info: https://rasa.com/docs/rasa/model-storage/#load-model-from-cloud"
        - name: model_storage_provider
          type: select_one
          title: Model storage provider
          default: aws
          items:
            - name: aws
              title: AWS S3 Bucket
            - name: gcs
              title: Google Cloud Storage
        - name: model_storage_type
          type: text
          title: Model storage Type
          default: '{{repl (ConfigOptionEquals "model_storage_provider" "aws") | ternary "aws" "gcs"}}'
          hidden: true
        - name: rasa_pro_bucket_name
          type: text
          title: Rasa Pro Bucket name
          help_text: "S3 or GCS bucket name, eg: rasa-pro-model-bucket"
        - name: model_file
          type: text
          title: Model file name
          default: "20240523-154518-ancient-xylophone.tar.gz"
        # AWS credentials
        - name: aws_access_key_id
          type: text
          title: AWS ACCESS KEY ID
          when: '{{repl ConfigOptionEquals "model_storage_provider" "aws"}}'
        - name: aws_secret_access_key
          type: text
          title: AWS SECRET ACCESS KEY
          when: '{{repl ConfigOptionEquals "model_storage_provider" "aws"}}'
        - name: aws_default_region
          type: text
          title: AWS DEFAULT REGION
          when: '{{repl ConfigOptionEquals "model_storage_provider" "aws"}}'
        # GCS credentials
        - name: gcs_json
          type: text
          title: Google application credentials
          help_text: "GCP SA Base64Encoded"
          when: '{{repl ConfigOptionEquals "model_storage_provider" "gcs"}}'
        - name: set_rasa_pro_resources
          type: bool
          title: Configure Rasa Pro resources
          default: "0"
          help_text: Check this option if you want to configure resource requests/limits for Rasa Pro deployment
        - name: set_rasa_pro_limits_cpu
          type: text
          title: Rasa Pro CPU limit
          help_text: Configure Rasa Pro resource limit for CPU
          when: '{{repl ConfigOptionEquals "set_rasa_pro_resources" "1"}}'
        - name: set_rasa_pro_limits_memory
          type: text
          title: Rasa Pro Memory limit
          help_text: Configure Rasa Pro resource limit for Memory
          when: '{{repl ConfigOptionEquals "set_rasa_pro_resources" "1"}}'
        - name: set_rasa_pro_requests_cpu
          type: text
          title: Rasa Pro CPU requests
          help_text: Configure Rasa Pro resource requests for CPU
          when: '{{repl ConfigOptionEquals "set_rasa_pro_resources" "1"}}'
        - name: set_rasa_pro_requests_memory
          type: text
          title: Rasa Pro Memory requests
          help_text: Configure Rasa Pro resource requests for Memory
          when: '{{repl ConfigOptionEquals "set_rasa_pro_resources" "1"}}'
    - name: Rasa Pro Services
      description: >
        This section configures Rasa Pro Services deployment
      title: Rasa Pro Services
      when: 'repl{{ ConfigOptionNotEquals `rasa_platform_deploy` `studio` }}'
      items:
      - name: deploy_analytics
        type: bool
        title: Deploy Analytics
        default: "0"
      - name: rasa_pro_services_image_tag
        type: text
        title: Rasa Pro Analytics version
        default: "3.2.3-latest"
        help_text: Specifies image tag for Rasa Pro Analytics
        when: '{{repl ConfigOptionEquals "deploy_analytics" "1"}}'
      - name: rasa_pro_services_logging_level
        type: text
        title: Rasa Pro Services logging level
        default: "INFO"
        when: '{{repl ConfigOptionEquals "deploy_analytics" "1"}}'
      - name: set_analytics_resources
        type: bool
        title: Configure Rasa Pro Analytics resources
        default: "0"
        help_text: Check this option if you want to configure resource requests/limits for Rasa Pro Analytics deployment
      - name: set_analytics_limits_cpu
        type: text
        title: Rasa Pro Analytics CPU limit
        help_text: Configure Rasa Pro Analytics resource limit for CPU
        when: '{{repl ConfigOptionEquals "set_analytics_resources" "1"}}'
      - name: set_analytics_limits_memory
        type: text
        title: Rasa Pro Analytics Memory limit
        help_text: Configure Rasa Pro Analytics resource limit for Memory
        when: '{{repl ConfigOptionEquals "set_analytics_resources" "1"}}'
      - name: set_analytics_requests_cpu
        type: text
        title: Rasa Pro Analytics CPU requests
        help_text: Configure Rasa Pro Analytics resource requests for CPU
        when: '{{repl ConfigOptionEquals "set_analytics_resources" "1"}}'
      - name: set_analytics_requests_memory
        type: text
        title: Rasa Pro Analytics Memory requests
        help_text: Configure Rasa Pro Analytics resource requests for Memory
        when: '{{repl ConfigOptionEquals "set_analytics_resources" "1"}}'
    - name: Action Server
      description: >
        This section configures Action Server deployment
      title: Action Server
      when: 'repl{{ ConfigOptionNotEquals `rasa_platform_deploy` `studio` }}'
      items:
        - name: action_server_image_tag
          type: text
          title: Action Server version
          default: "calm"
          help_text: Specifies image tag for Action Server
        - name: action_server
          type: bool
          title: Enable Action Server
          default: "0"
        - name: action_server_replica_count
          type: text
          title: Action Server replica count
          default: "1"
        - name: action_service_port
          type: text
          title: Action Server port
          default: "5055"
          help_text: Specifies image tag for Action Server
        - name: action_server_service_type
          type: text
          title: Action Server service type
          default: "ClusterIP"
        - name: action_server_settings_schema
          type: text
          title: Action Server schema
          default: "http"
    - name: Redis
      description: >
          This section covers Redis configuration
      title: Redis
      when: 'repl{{ ConfigOptionNotEquals `rasa_platform_deploy` `studio` }}'
      items:
        - name: redis_type
          type: select_one
          title: Redis
          default: embedded_redis
          items:
            - name: embedded_redis
              title: Embedded Redis
            - name: external_redis
              title: External Redis
        - name: redis_password
          type: password
          title: Redis password
          default: redis
          when: 'repl{{ ConfigOptionEquals `redis_type` `external_redis` }}'
